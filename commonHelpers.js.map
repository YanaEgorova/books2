{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["class BooksApi {\n  constructor() {\n    this.BASE_URL = 'http://localhost:3000';\n    this.END_POINT = '/books';\n  }\n\n  getBooks() {\n    const url = this.BASE_URL + this.END_POINT;\n\n    return fetch(url).then(res => {\n      if (res.ok) {\n        return res.json();\n      } else {\n        throw new Error(res.status);\n      }\n    });\n  }\n  createBook(book) {\n    const url = this.BASE_URL + this.END_POINT;\n\n    const options = {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(book),\n    };\n\n    return fetch(url, options).then(res => {\n      if (res.ok) {\n        return res.json();\n      } else {\n        throw new Error(res.status);\n      }\n    });\n  }\n  updateBook({ id, ...book }) {\n    const url = `${this.BASE_URL}${this.END_POINT}/${id}`;\n\n    const options = {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(book),\n    };\n\n    return fetch(url, options).then(res => {\n      if (res.ok) {\n        return res.json();\n      } else {\n        throw new Error(res.status);\n      }\n    });\n  }\n  resetBook({ id, ...book }) {\n    const url = `${this.BASE_URL}${this.END_POINT}/${id}`;\n\n    const options = {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(book),\n    };\n\n    return fetch(url, options).then(res => {\n      if (res.ok) {\n        return res.json();\n      } else {\n        throw new Error(res.status);\n      }\n    });\n  }\n  deleteBook(id) {\n    const url = `${this.BASE_URL}${this.END_POINT}/${id}`;\n\n    const options = {\n      method: 'DELETE',\n    };\n\n    return fetch(url, options).then(res => {\n      if (res.ok) {\n        return res.json();\n      } else {\n        throw new Error(res.status);\n      }\n    });\n  }\n}\n\nconst refs = {\n  createFormEl: document.querySelector('.js-create-form'),\n  resetFormEl: document.querySelector('.js-reset-form'),\n  updateFormEl: document.querySelector('.js-update-form'),\n  deleteFormEl: document.querySelector('.js-delete-form'),\n  listEl: document.querySelector('.js-list'),\n};\n\nrefs.createFormEl.addEventListener('submit', onBookCreate);\nrefs.resetFormEl.addEventListener('submit', onBookReset);\nrefs.updateFormEl.addEventListener('submit', onBookUpdate);\nrefs.deleteFormEl.addEventListener('submit', onBookDelete);\nrefs.listEl.addEventListener('click', onBookClick);\n\nfunction onBookClick(e) {\n  console.log(e.target);\n  console.log(e.currentTarget);\n\n  if (e.target === e.currentTarget) return;\n  const id = e.target.closest('li').dataset.id;\n\n  refs.resetFormEl.elements.id.value = id;\n  refs.updateFormEl.elements.id.value = id;\n  refs.deleteFormEl.elements.id.value = id;\n}\n\nconst booksApi = new BooksApi();\n\nfunction onBookCreate(e) {\n  e.preventDefault();\n\n  // const title = e.target.elements.title.value;\n  // const author = e.target.elements.author.value;\n  // const description = e.target.elements.description.value;\n\n  // const book = {\n  //   title,\n  //   author,\n  //   description,\n  // };\n\n  // OR\n\n  const book = {};\n\n  const formData = new FormData(e.target);\n  formData.forEach((value, key) => {\n    book[key] = value;\n  });\n  console.log(book);\n  booksApi.createBook(book).then(newBook => {\n    const markup = bookTemplate(newBook);\n    refs.listEl.insertAdjacentHTML('afterbegin', markup);\n  });\n  e.target.reset();\n}\nfunction onBookReset(e) {\n  e.preventDefault();\n  const book = {};\n\n  const formData = new FormData(e.target);\n  formData.forEach((value, key) => {\n    book[key] = value;\n  });\n  booksApi.resetBook(book).then(updatedBook => {\n    const oldBook = document.querySelector(`[data-id=${book.id}]`);\n    const markup = bookTemplate(updatedBook);\n    oldBook.insertAdjacentHTML('afterend', markup);\n    oldBook.remove();\n  });\n  e.target.reset();\n}\nfunction onBookUpdate(e) {\n  const book = {};\n\n  const formData = new FormData(e.target);\n  formData.forEach((value, key) => {\n    if (!value) return;\n    book[key] = value;\n  });\n  booksApi.updateBook(book).then(updatedBook => {\n    const oldBook = document.querySelector(`[data-id=${book.id}]`);\n    const markup = bookTemplate(updatedBook);\n    oldBook.insertAdjacentHTML('afterend', markup);\n    oldBook.remove();\n  });\n  e.target.reset();\n}\nfunction onBookDelete(e) {\n  e.preventDefault();\n\n  const id = e.target.elements.id.value;\n\n  booksApi.deleteBook(id).then(res => {\n    const oldBook = document.querySelector(`[data-id=${id}]`);\n    oldBook.remove();\n  });\n  e.target.reset();\n}\n\nfunction bookTemplate({ id, author, title, description }) {\n  return `\n       <li data-id=\"${id}\">\n        <p><span>ID:</span> ${id}</p>\n        <p><span>Author:</span> ${author}</p>\n        <p><span>Title:</span> ${title}</p>\n        <p><span>Description:</span> ${description}</p>\n      </li>\n  `;\n}\n\nfunction booksTemplates(books) {\n  return books.map(bookTemplate).reverse().join('');\n}\n\nfunction renderBooks(books) {\n  const markup = booksTemplates(books);\n  refs.listEl.innerHTML = markup;\n}\n\nbooksApi.getBooks().then(renderBooks).catch(onError);\n\nfunction onError(error) {\n  switch (error.message) {\n    case '404':\n      console.log('404');\n      break;\n    case '401':\n      console.log('401');\n      break;\n    default:\n      console.log('Unknown error');\n  }\n}\n"],"names":["BooksApi","url","res","book","options","id","refs","onBookCreate","onBookReset","onBookUpdate","onBookDelete","onBookClick","e","booksApi","value","key","newBook","markup","bookTemplate","updatedBook","oldBook","author","title","description","booksTemplates","books","renderBooks","onError","error"],"mappings":"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"}